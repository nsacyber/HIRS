<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout}">

<head>
    <title th:text="'Attestation Identity CA Policy Options'">Attestation Identity CA Policy Options</title>
</head>

<section layout:fragment="script">
    <script th:inline="javascript">
        function showModal(modalId, modalContentId) {
            const modalContentSelector = ".modal-body " + modalContentId;

            // show the selected modal
            $(modalId).modal('show')

            // display the invisible content on the modal by removing the css class that makes the elements invisible
            $(modalContentSelector).removeClass("modal-visibility-on-close");

        }

        function submitProtobufLogSetting() {
            // find the selected protobuf log setting
            let form = $('input[name="saveProtobufToLogOption"]:checked').closest('form');

            // Submit the form
            form.submit();

            // Log the selected value to the console (for debugging)
            console.log('Selected value: ' + $('input[name="saveProtobufToLogOption"]:checked').val());
        }

    </script>
</section>

<body>
    <h1 layout:fragment="pageHeaderTitle"> Attestation Identity CA Policy Options </h1>
    <section layout:fragment="content">
        <ul>
            <!-- Endorsement validation  -->
            <li>
                <div class="aca-input-box">
                    <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-ec-validation}"
                        th:object="${initialData}" method="POST">
                        Endorsement Credential Validation:
                        <span th:text="${initialData.enableEcValidation ? 'Enabled' : 'Disabled'}"></span>

                        <!-- Define the content of the modal -->
                        <div id="ecPolicyBody" th:fragment="ecPolicyBody" class="modal-visibility-on-close ">
                            <div class="radio">
                                <label>
                                    <input id="ecTop" type="radio" name="ecValidate"
                                        th:checked="${initialData.enableEcValidation}" value="checked" />
                                    Endorsement Credentials will be validated
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input id="ecBot" type="radio" name="ecValidate"
                                        th:checked="${!initialData.enableEcValidation}" value="unchecked" />
                                    Endorsement Credentials will not be validated
                                </label>
                            </div>
                        </div>

                        <!-- Trigger to open the modal -->
                        <a th:href="'#' + ecPolicyEditor" onclick='showModal("#ecPolicyEditor", "#ecPolicyBody")'>
                            <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                        </a>

                        <!-- modal fragment -->
                        <div th:replace="fragments/modal :: modal( id='ecPolicyEditor', label='Edit Endorsement
                            Credential Validation Policy Settings', bodyContent=~{this::ecPolicyBody})">
                        </div>
                    </form>
                </div>
            </li>

            <!-- Platform validation -->
            <li>
                <div class="aca-input-box">
                    <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-pc-validation}"
                        th:object="${initialData}" method="POST">
                        Platform Credential Validation:
                        <span th:text="${initialData.enablePcCertificateValidation ? 'Enabled' : 'Disabled'}"></span>

                        <!-- Define the content of the modal -->
                        <div id="pcPolicyBody" th:fragment="pcPolicyBody" class="modal-visibility-on-close">
                            <div class="radio">
                                <label>
                                    <input id="pcTop" type="radio" name="pcValidate"
                                        th:checked="${initialData.enablePcCertificateValidation}" value="checked" />
                                    Platform Credentials will be validated
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input id="pcBot" type="radio" name="pcValidate"
                                        th:checked="${!initialData.enablePcCertificateValidation}" value="unchecked" />
                                    Platform Credentials will not be validated
                                </label>
                            </div>
                        </div>

                        <!-- trigger to open the modal -->
                        <a th:href="'#' + pcPolicyEditor" onclick='showModal("#pcPolicyEditor", "#pcPolicyBody")'>
                            <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                        </a>

                        <!-- modal fragment -->
                        <div
                            th:replace="fragments/modal :: modal( id='pcPolicyEditor',  label='Edit Platform Credential Validation Policy Settings', bodyContent=~{this::pcPolicyBody})">
                        </div>
                    </form>
                </div>
            </li>

            <!-- Platform attribute validation -->
            <li>
                <div class="aca-input-box">
                    <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-pc-attribute-validation}"
                        th:object="${initialData}" method="POST">
                        Platform Attribute Credential Validation:
                        <span
                            th:text="${initialData.enablePcCertificateAttributeValidation ? 'Enabled' : 'Disabled'}"></span>

                        <!-- Define the content of the modal -->
                        <div id="pcAttrPolicyBody" th:fragment="pcAttrPolicyBody" class="modal-visibility-on-close">
                            <div class="radio">
                                <label>
                                    <input id="pcAttrTop" type="radio" name="pcAttributeValidate"
                                        th:checked="${initialData.enablePcCertificateAttributeValidation}"
                                        value="checked" />
                                    Platform Credential Attributes will be validated
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input id="pcAttrBot" type="radio" name="pcAttributeValidate"
                                        th:checked="${!initialData.enablePcCertificateAttributeValidation}"
                                        value="unchecked" />
                                    Platform Credential Attributes will not be validated
                                </label>
                            </div>
                        </div>

                        <!-- trigger to open the modal -->
                        <a th:href="'#' + pcAttrPolicyEditor"
                            onclick='showModal("#pcAttrPolicyEditor", "#pcAttrPolicyBody")'>
                            <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                        </a>

                        <!-- modal fragment -->
                        <div
                            th:replace="fragments/modal :: modal( id='pcAttrPolicyEditor',  label='Edit Platform Credential Attribute Validation Policy Settings', bodyContent=~{this::pcAttrPolicyBody})">
                        </div>
                    </form>

                    <ul>
                        <li>
                            <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-revision-ignore}"
                                th:object="${initialData}" method="POST">
                                Ignore Component Revision Attribute:
                                <span
                                    th:text="${initialData.enableIgnoreRevisionAttribute ? 'Enabled' : 'Disabled'}"></span>

                                <!-- Define the content of the modal -->
                                <div id="revisionIgnoredPolicyBody" th:fragment="revisionIgnoredPolicyBody"
                                    class="modal-visibility-on-close">
                                    <div class="radio">
                                        <label>
                                            <input id="revisionTop" type="radio" name="ignoreRevisionAttribute"
                                                th:checked="${initialData.enableIgnoreRevisionAttribute}"
                                                value="checked" />
                                            Component Revision Attribute enabled
                                        </label>
                                    </div>
                                    <div class="radio">
                                        <label>
                                            <input id="revisionBot" type="radio" name="ignoreRevisionAttribute"
                                                th:checked="${!initialData.enableIgnoreRevisionAttribute}"
                                                value="unchecked" />
                                            Component Revision Attribute disabled
                                        </label>
                                    </div>
                                </div>

                                <!-- trigger to open the modal -->
                                <a th:href="'#' + revisionIgnoredPolicyEditor"
                                    onclick='showModal("#revisionIgnoredPolicyEditor", "#revisionIgnoredPolicyBody")'>
                                    <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                                </a>

                                <!-- modal fragment -->
                                <div
                                    th:replace="fragments/modal :: modal( id='revisionIgnoredPolicyEditor',  label='Edit Ignore Component Revision Policy Settings', bodyContent=~{this::revisionIgnoredPolicyBody})">
                                </div>
                            </form>
                        </li>

                        <li>
                            <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-pcie-vpd-ignore}"
                                th:object="${initialData}" method="POST">
                                Ignore PCIE VPD Attribute:
                                <span
                                    th:text="${initialData.enableIgnorePcieVpdAttribute ? 'Enabled' : 'Disabled'}"></span>

                                <!-- Define the content of the modal -->
                                <div id="pcieVpdIgnoredPolicyBody" th:fragment="pcieVpdIgnoredPolicyBody"
                                    class="modal-visibility-on-close">
                                    <div class="radio">
                                        <label>
                                            <input id="pcieVpdTop" type="radio" name="ignorePcieVpdAttribute"
                                                th:checked="${initialData.enableIgnorePcieVpdAttribute}"
                                                value="checked" />
                                            PCIE VPD Attribute enabled
                                        </label>
                                    </div>
                                    <div class="radio">
                                        <label>
                                            <input id="pcieVpdBot" type="radio" name="ignorePcieVpdAttribute"
                                                th:checked="${!initialData.enableIgnorePcieVpdAttribute}"
                                                value="unchecked" />
                                            PCIE VPD Attribute disabled
                                        </label>
                                    </div>
                                </div>

                                <!-- trigger to open the modal -->
                                <a th:href="'#' + ignorePcieVpdPolicyEditor"
                                    onclick='showModal("#ignorePcieVpdPolicyEditor", "#pcieVpdIgnoredPolicyBody")'>
                                    <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                                </a>

                                <!-- modal fragment -->
                                <div
                                    th:replace="fragments/modal :: modal( id='ignorePcieVpdPolicyEditor',  label='Edit Ignore PCIE VPD Policy Settings', bodyContent=~{this::pcieVpdIgnoredPolicyBody})">
                                </div>
                            </form>

                        </li>
                    </ul>
                </div>
            </li>

            <!-- Firmware validation -->
            <li>
                <div class="aca-input-box">
                    <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-firmware-validation}"
                        th:object="${initialData}" method="POST">
                        Firmware Validation:
                        <span th:text="${initialData.enableFirmwareValidation ? 'Enabled' : 'Disabled'}"></span>

                        <!-- Define the content of the modal -->
                        <div id="firmwarePolicyBody" th:fragment="firmwarePolicyBody" class="modal-visibility-on-close">
                            <div class="radio">
                                <label>
                                    <input id="firmwareTop" type="radio" name="fmValidate"
                                        th:checked="${initialData.enableFirmwareValidation}" value="checked" />
                                    Firmware will be validated
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input id="firmwareBottom" type="radio" name="fmValidate"
                                        th:checked="${!initialData.enableFirmwareValidation}" value="unchecked" />
                                    Firmware will not be validated
                                </label>
                            </div>
                        </div>

                        <!-- trigger to open the modal -->
                        <a th:href="'#' + fwPolicyEditor" onclick='showModal("#fwPolicyEditor", "#firmwarePolicyBody")'>
                            <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                        </a>

                        <!-- modal fragment -->
                        <div
                            th:replace="fragments/modal :: modal( id='fwPolicyEditor',  label='Edit Firmware Validation Policy Settings', bodyContent=~{this::firmwarePolicyBody})">
                        </div>
                    </form>

                    <ul>
                        <li>
                            <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-ima-ignore}"
                                th:object="${initialData}" method="POST">
                                Ignore IMA PCR Entry:
                                <span th:text="${initialData.enableIgnoreIma ? 'Enabled' : 'Disabled'}"></span>

                                <!-- Define the content of the modal -->
                                <div id="imaIgnoredPolicyBody" th:fragment="imaIgnoredPolicyBody"
                                    class="modal-visibility-on-close">
                                    <div class="radio">
                                        <label>
                                            <input id="imaTop" type="radio" name="ignoreIma"
                                                th:checked="${initialData.enableIgnoreIma}" value="checked" />
                                            Ignore IMA enabled
                                        </label>
                                    </div>
                                    <div class="radio">
                                        <label>
                                            <input id="imaBot" type="radio" name="ignoreIma"
                                                th:checked="${!initialData.enableIgnoreIma}" value="unchecked" />
                                            Ignore IMA disabled
                                        </label>
                                    </div>
                                </div>

                                <!-- trigger to open the modal -->
                                <a th:href="'#' + ignoreImaPolicyEditor"
                                    onclick='showModal("#ignoreImaPolicyEditor", "#imaIgnoredPolicyBody")'>
                                    <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                                </a>

                                <!-- modal fragment -->
                                <div
                                    th:replace="fragments/modal :: modal( id='ignoreImaPolicyEditor',  label='Edit Ignore IMA Policy Settings', bodyContent=~{this::imaIgnoredPolicyBody})">
                                </div>
                            </form>
                        </li>

                        <li>
                            <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-tboot-ignore}"
                                th:object="${initialData}" method="POST">
                                Ignore TBOOT PCRs Entry:
                                <span th:text="${initialData.enableIgnoreTboot ? 'Enabled' : 'Disabled'}"></span>

                                <!-- Define the content of the modal -->
                                <div id="tbootIgnoredPolicyBody" th:fragment="tbootIgnoredPolicyBody"
                                    class="modal-visibility-on-close">
                                    <div class="radio">
                                        <label>
                                            <input id="tbootTop" type="radio" name="ignoretBoot"
                                                th:checked="${initialData.enableIgnoreTboot}" value="checked" />
                                            Ignore TBoot enabled
                                        </label>
                                    </div>
                                    <div class="radio">
                                        <label>
                                            <input id="tbootBot" type="radio" name="ignoretBoot"
                                                th:checked="${!initialData.enableIgnoreTboot}" value="unchecked" />
                                            Ignore TBoot disabled
                                        </label>
                                    </div>
                                </div>

                                <!-- trigger to open the modal -->
                                <a th:href="'#' + ignoreTbootPolicyEditor"
                                    onclick='showModal("#ignoreTbootPolicyEditor", "#tbootIgnoredPolicyBody")'>
                                    <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                                </a>

                                <!-- modal fragment -->
                                <div
                                    th:replace="fragments/modal :: modal( id='ignoreTbootPolicyEditor',  label='Edit Ignore Tboot Policy Settings', bodyContent=~{this::tbootIgnoredPolicyBody})">
                                </div>
                            </form>
                        </li>

                        <li>
                            <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-gpt-ignore}"
                                th:object="${initialData}" method="POST">
                                Ignore GPT PCRs Entry:
                                <span th:text="${initialData.enableIgnoreGpt ? 'Enabled' : 'Disabled'}"></span>

                                <!-- Define the content of the modal -->
                                <div id="gptIgnoredPolicyBody" th:fragment="gptIgnoredPolicyBody"
                                    class="modal-visibility-on-close">
                                    <div class="radio">
                                        <label>
                                            <input id="gptTop" type="radio" name="ignoreGpt"
                                                th:checked="${initialData.enableIgnoreGpt}" value="checked" />
                                            Ignore GPT enabled
                                        </label>
                                    </div>
                                    <div class="radio">
                                        <label>
                                            <input id="gptBot" type="radio" name="ignoreGpt"
                                                th:checked="${!initialData.enableIgnoreGpt}" value="unchecked" />
                                            Ignore GPT disabled
                                        </label>
                                    </div>
                                </div>

                                <!-- trigger to open the modal -->
                                <a th:href="'#' + ignoreGptPolicyEditor"
                                    onclick='showModal("#ignoreGptPolicyEditor", "#gptIgnoredPolicyBody")'>
                                    <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                                </a>

                                <!-- modal fragment -->
                                <div
                                    th:replace="fragments/modal :: modal( id='ignoreGptPolicyEditor',  label='Edit Ignore GPT Policy Settings', bodyContent=~{this::gptIgnoredPolicyBody})">
                                </div>
                            </form>
                        </li>

                        <li>
                            <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-os-evt-ignore}"
                                th:object="${initialData}" method="POST">
                                Ignore OS Events:
                                <span th:text="${initialData.enableIgnoreOsEvt ? 'Enabled' : 'Disabled'}"></span>

                                <!-- Define the content of the modal -->
                                <div id="osIgnoredPolicyBody" th:fragment="osIgnoredPolicyBody"
                                    class="modal-visibility-on-close">
                                    <div class="radio">
                                        <label>
                                            <input id="osTop" type="radio" name="ignoreOsEvt"
                                                th:checked="${initialData.enableIgnoreOsEvt}" value="checked" />
                                            Ignore OS Events enabled
                                        </label>
                                    </div>
                                    <div class="radio">
                                        <label>
                                            <input id="osBot" type="radio" name="ignoreOsEvt"
                                                th:checked="${!initialData.enableIgnoreOsEvt}" value="unchecked" />
                                            Ignore OS Events disabled
                                        </label>
                                    </div>
                                </div>

                                <!-- trigger to open the modal -->
                                <a th:href="'#' + ignoreOSPolicyEditor"
                                    onclick='showModal("#ignoreOSPolicyEditor", "#osIgnoredPolicyBody")'>
                                    <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                                </a>

                                <!-- modal fragment -->
                                <div
                                    th:replace="fragments/modal :: modal( id='ignoreOSPolicyEditor',  label='Edit Ignore OS Events Policy Settings', bodyContent=~{this::osIgnoredPolicyBody})">
                                </div>
                            </form>
                        </li>
                    </ul>
                </div>
            </li>

            <!-- Generate Attestation Certificate  -->
            <li>
                <div class="aca-input-box">
                    <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-issued-attestation-generation}"
                        th:object="${initialData}" method="POST">
                        Generate Attestation Certificate:
                        <span th:text="${initialData.issueAttestationCertificate ? 'Enabled' : 'Disabled'}"></span>

                        <!-- Define the content of the modal -->
                        <div id="genAttestCertPolicyBody" th:fragment="genAttestCertPolicyBody"
                            class="modal-visibility-on-close">
                            <div class="radio">
                                <label>
                                    <input id="attestTop" type="radio" name="attestationCertificateIssued"
                                        th:checked="${!initialData.issueAttestationCertificate}" value="unchecked" />
                                    Never generate an Attestation Certificate
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input id="attestBottom" type="radio" name="attestationCertificateIssued"
                                        th:checked="${initialData.issueAttestationCertificate}" value="checked" />
                                    Conditionally generate an Attestation Certificate before 'Not After' expiration date
                                </label>
                            </div>
                        </div>

                        <!-- trigger to open the modal -->
                        <a th:href="'#' + issuedCertificatePolicyEditor"
                            onclick='showModal("#issuedCertificatePolicyEditor", "#genAttestCertPolicyBody")'>
                            <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                        </a>

                        <!-- modal fragment -->
                        <div
                            th:replace="fragments/modal :: modal( id='issuedCertificatePolicyEditor',  label='Edit Issued Attestation Certificate Policy Settings', bodyContent=~{this::genAttestCertPolicyBody})">
                        </div>
                    </form>

                    <ul>
                        <li>
                            <form
                                th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-attestation-certificate-expiration}"
                                th:object="${initialData}" method="POST">
                                Attestation Certificate Validity period:
                                <span th:text="${initialData.generateOnExpiration ? 'Enabled' : 'Disabled'}"></span>

                                <!-- Define the content of the modal -->
                                <div id="expCertPolicyBody" th:fragment="expCertPolicyBody"
                                    class="modal-visibility-on-close">
                                    <div class="radio">
                                        <label>
                                            <input id="aicBot" type="checkbox" name="generationExpirationOn"
                                                th:checked="${initialData.generateOnExpiration}" value="checked" />
                                            Attestation Certificate validity period (Default 3651 days)<br />
                                            Select period in days:
                                            <input id="expirationValue" type="text" name="expirationValue"
                                                th:value="${initialData.expirationValue}" />
                                        </label>
                                    </div>
                                </div>

                                <!-- trigger to open the modal -->
                                <a th:href="'#' + issuedCertificatePolicyExpirationEditor"
                                    onclick='showModal("#issuedCertificatePolicyExpirationEditor", "#expCertPolicyBody")'>
                                    <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                                </a>

                                <!-- modal fragment -->
                                <div
                                    th:replace="fragments/modal :: modal( id='issuedCertificatePolicyExpirationEditor',  label='Edit Generate Certificate Expiration Policy Settings', bodyContent=~{this::expCertPolicyBody})">
                                </div>
                            </form>
                        </li>

                        <li>
                            <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-issued-cert-threshold}"
                                th:object="${initialData}" method="POST">
                                Attestation Certificate Renewal period:
                                <span th:text="${initialData.generateOnExpiration ? 'Enabled' : 'Disabled'}"></span>

                                <!-- Define the content of the modal -->
                                <div id="thresholdCertPolicyBody" th:fragment="thresholdCertPolicyBody"
                                    class="modal-visibility-on-close">
                                    <div class="radio">
                                        <label>
                                            <input id="aicBot" type="checkbox" name="generationExpirationOn"
                                                th:checked="${initialData.generateOnExpiration}" value="checked" />
                                            Renew 'n' days before Attestation Certificate's 'Not After' Validity date
                                            (Default 365 days)<br />
                                            Select 'n' period in days:
                                            <input id="thresholdValue" type="text" name="thresholdValue"
                                                th:value="${initialData.thresholdValue}" />
                                        </label>
                                    </div>
                                </div>

                                <!-- trigger to open the modal -->
                                <a th:href="'#' + issuedCertificatePolicyRenewalEditor"
                                    onclick='showModal("#issuedCertificatePolicyRenewalEditor", "#thresholdCertPolicyBody")'>
                                    <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                                </a>

                                <!-- modal fragment -->
                                <div
                                    th:replace="fragments/modal :: modal( id='issuedCertificatePolicyRenewalEditor',  label='Edit Generate Certificate Renewal Policy Settings', bodyContent=~{this::thresholdCertPolicyBody})">
                                </div>
                            </form>
                        </li>
                    </ul>
                </div>
            </li>


            <!-- Generate LDevID Certificate -->
            <li>
                <div class="aca-input-box">
                    <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-issued-ldevid-generation}"
                        th:object="${initialData}" method="POST">
                        Generate LDevID Certificate:
                        <span th:text="${initialData.issueDevIdCertificate ? 'Enabled' : 'Disabled'}"></span>

                        <!-- Define the content of the modal -->
                        <div id="genLDevIDCertPolicyBody" th:fragment="genLDevIDCertPolicyBody"
                            class="modal-visibility-on-close">
                            <div class="radio">
                                <label>
                                    <input id="devIdTop" type="radio" name="devIdCertificateIssued"
                                        th:checked="${!initialData.issueDevIdCertificate}" value="unchecked" />
                                    Never generate a DevID Certificate
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input id="devIdBottom" type="radio" name="devIdCertificateIssued"
                                        th:checked="${initialData.issueDevIdCertificate}" value="checked" />
                                    Conditionally generate an DevID Certificate before 'Not After' expiration date
                                </label>
                            </div>
                        </div>

                        <!-- trigger to open the modal -->
                        <a th:href="'#' + ldevidCertificatePolicyEditor"
                            onclick='showModal("#ldevidCertificatePolicyEditor", "#genLDevIDCertPolicyBody")'>
                            <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                        </a>

                        <!-- modal fragment -->
                        <div
                            th:replace="fragments/modal :: modal( id='ldevidCertificatePolicyEditor',  label='Edit LDevID Certificate Generation Policy Settings', bodyContent=~{this::genLDevIDCertPolicyBody})">
                        </div>
                    </form>

                    <ul>
                        <li>
                            <form
                                th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-ldevid-certificate-expiration}"
                                th:object="${initialData}" method="POST">
                                LDevID Certificate Validity period:
                                <span th:text="${initialData.devIdExpirationFlag ? 'Enabled' : 'Disabled'}"></span>

                                <!-- Define the content of the modal -->
                                <div id="expirationLvedvIdCertPolicyBody" th:fragment="expirationLvedvIdCertPolicyBody"
                                    class="modal-visibility-on-close">
                                    <div class="radio">
                                        <label>
                                            <input id="devIdBot" type="checkbox" name="devIdExpirationChecked"
                                                th:checked="${initialData.devIdExpirationFlag}" value="checked" />
                                            LDevID Certificate validity period (Default 3651 days)<br />
                                            Select period in days:
                                            <input id="devIdExpirationValue" type="text" name="devIdExpirationValue"
                                                th:value="${initialData.devIdExpirationValue}" />
                                        </label>
                                    </div>
                                </div>

                                <!-- trigger to open the modal -->
                                <a th:href="'#' + ldevidCertificateExpirationPolicyEditor"
                                    onclick='showModal("#ldevidCertificateExpirationPolicyEditor", "#expirationLvedvIdCertPolicyBody")'>
                                    <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                                </a>

                                <!-- modal fragment -->
                                <div
                                    th:replace="fragments/modal :: modal( id='ldevidCertificateExpirationPolicyEditor',  label='Edit LDevID Certificate Expiration Policy Settings', bodyContent=~{this::expirationLvedvIdCertPolicyBody})">
                                </div>
                            </form>
                        </li>

                        <li>
                            <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-ldevid-threshold}"
                                th:object="${initialData}" method="POST">
                                LDevID Certificate Renewal period:
                                <span th:text="${initialData.devIdExpirationFlag ? 'Enabled' : 'Disabled'}"></span>

                                <!-- Define the content of the modal -->
                                <div id="thresholdLvedvIdCertPolicyBody" th:fragment="thresholdLvedvIdCertPolicyBody"
                                    class="modal-visibility-on-close">
                                    <div class="radio">
                                        <label>
                                            <input id="devIdBot" type="checkbox" name="devIdExpirationChecked"
                                                th:checked="${initialData.devIdExpirationFlag}" value="checked" />
                                            Renew 'n' days before LDevID Certificate's 'Not After' Validity date
                                            (Default 365 days)<br />
                                            Select 'n' period in days:
                                            <input id="devIdThresholdValue" type="text" name="devIdThresholdValue"
                                                th:value="${initialData.devIdThresholdValue}" />
                                        </label>
                                    </div>
                                </div>

                                <!-- trigger to open the modal -->
                                <a th:href="'#' + ldevidCertificateRenewalPolicyEditor"
                                    onclick='showModal("#ldevidCertificateRenewalPolicyEditor", "#thresholdLvedvIdCertPolicyBody")'>
                                    <img th:src="@{/icons/ic_mode_edit_blue_18dp.png}" alt="Editor Icon" />
                                </a>

                                <!-- modal fragment -->
                                <div
                                    th:replace="fragments/modal :: modal( id='ldevidCertificateRenewalPolicyEditor',  label='Edit LDevID Certificate Renewal Policy Settings', bodyContent=~{this::thresholdLvedvIdCertPolicyBody})">
                                </div>
                            </form>
                        </li>
                    </ul>
                </div>
            </li>

            <!-- Save ProtoBuf Data To ACA Log After Validation -->
            <li>
                <div class="aca-input-box">
                    <form th:action="@{/HIRS_AttestationCAPortal/portal/policy/update-save-protobuf-data-to-log}"
                        th:object="${initialData}" method="POST">
                        <p>Save Protobuf Data To ACA Log Settings:</p>

                        <ul>
                            <li>
                                <div class="radio">
                                    <input type="radio" name="saveProtobufToLogOption" value="always-log-protobuf"
                                        onchange="submitProtobufLogSetting()"
                                        th:checked="${initialData.logProtobufAlways}" />
                                    Log Protobuf Data Always<br />

                                    <input type="radio" name="saveProtobufToLogOption" value="log-protobuf-on-fail-val"
                                        onchange="submitProtobufLogSetting()"
                                        th:checked="${initialData.logProtobufOnFailedVal}" />
                                    Log Protobuf Data on Validation Failure<br />

                                    <input type="radio" name="saveProtobufToLogOption" value="never-log-protobuf"
                                        onchange="submitProtobufLogSetting()"
                                        th:checked="${initialData.logProtobufNever}" />
                                    Never Log Protobuf Data<br />
                                </div>
                            </li>
                        </ul>
                    </form>
                </div>
            </li>
        </ul>
    </section>
</body>

</html>