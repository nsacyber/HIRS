<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout}">

<head>
    <title th:text="'Attestation Identity CA Policy Options'">Attestation Identity CA Policy Options</title>
</head>

<script>
    document.querySelectorAll('input[name="saveProtobufToLogOption"]').forEach(radio => {
        radio.addEventListener('change', () => {
            radio.form.submit();
        });
    });
</script>

<body>
    <h1 layout:fragment="pageHeaderTitle"> Attestation Identity CA Policy Options </h1>
    <section layout:fragment="content">
        <ul>
            <!-- Endorsement validation  -->
            <div class="aca-input-box">
                <form th:action="@{/policy/update-ec-validation}" th:object="${initialData}" method="POST">
                    <li>
                        Endorsement Credential Validation:
                        <span th:text="${initialData.enableEcValidation ? 'Enabled' : 'Disabled'}"></span>

                        <!-- Define the content of the modal -->
                        <div th:fragment="ecPolicyBody">
                            <div class="radio">
                                <label>
                                    <input id="ecTop" type="radio" name="ecValidate"
                                        th:checked="${initialData.enableEcValidation}" value="checked" />
                                    Endorsement Credentials will be validated
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input id="ecBot" type="radio" name="ecValidate"
                                        th:checked="${!initialData.enableEcValidation}" value="unchecked" />
                                    Endorsement Credentials will not be validated
                                </label>
                            </div>
                        </div>

                        <!-- Use the editor fragment -->
                        <div
                            th:replace="fragments/editor :: editor( id='ecPolicyEditor',  label='Edit Endorsement Credential Validation Policy Settings', bodyContent=~{this::ecPolicyBody})">
                        </div>
                    </li>
                </form>


            </div>

            <!-- Platform validation -->
            <div class="aca-input-box">
                <form th:action="@{/policy/update-pc-validation}" th:object="${initialData}" method="POST">
                    <li>
                        Platform Credential Validation:
                        <span th:text="${initialData.enablePcCertificateValidation ? 'Enabled' : 'Disabled'}"></span>

                        <!-- Define the content of the modal -->
                        <div th:fragment="pcPolicyBody">
                            <div class="radio">
                                <label>
                                    <input id="pcTop" type="radio" name="pcValidate"
                                        th:checked="${initialData.enablePcCertificateValidation}" value="checked" />
                                    Platform Credentials will be validated
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input id="pcBot" type="radio" name="pcValidate"
                                        th:checked="${!initialData.enablePcCertificateValidation}" value="unchecked" />
                                    Platform Credentials will not be validated
                                </label>
                            </div>
                        </div>

                        <div
                            th:replace="fragments/editor :: editor( id='pcPolicyEditor',  label='Edit Platform Credential Validation Policy Settings', bodyContent=~{this::pcPolicyBody})">
                        </div>
                    </li>
                </form>
            </div>

            <!-- Platform attribute validation -->
            <div class="aca-input-box">
                <form th:action="@{/policy/update-pc-attribute-validation}" th:object="${initialData}" method="POST">
                    <li>
                        Platform Attribute Credential Validation:
                        <span
                            th:text="${initialData.enablePcCertificateAttributeValidation ? 'Enabled' : 'Disabled'}"></span>

                        <!-- Define the content of the modal -->
                        <div th:fragment="pcAttrPolicyBody">
                            <div class="radio">
                                <label>
                                    <input id="pcAttrTop" type="radio" name="pcAttributeValidate"
                                        th:checked="${initialData.enablePcCertificateAttributeValidation}"
                                        value="checked" />
                                    Platform Credential Attributes will be validated
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input id="pcAttrBot" type="radio" name="pcAttributeValidate"
                                        th:checked="${!initialData.enablePcCertificateAttributeValidation}"
                                        value="unchecked" />
                                    Platform Credential Attributes will not be validated
                                </label>
                            </div>
                        </div>

                        <div
                            th:replace="fragments/editor :: editor( id='pcAttrPolicyEditor',  label='Edit Platform Credential Attribute Validation Policy Settings', bodyContent=~{this::pcAttrPolicyBody})">
                        </div>
                    </li>
                </form>

                <form th:action="@{/policy/update-revision-ignore}" th:object="${initialData}" method="POST">
                    <ul>
                        <li>
                            Ignore Component Revision Attribute:
                            <span
                                th:text="${initialData.enableIgnoreRevisionAttribute ? 'Enabled' : 'Disabled'}"></span>

                            <!-- Define the content of the modal -->
                            <div th:fragment="revisionIgnoredPolicyBody">
                                <div class="radio">
                                    <label>
                                        <input id="revisionTop" type="radio" name="ignoreRevisionAttribute"
                                            th:checked="${initialData.enableIgnoreRevisionAttribute}" value="checked" />
                                        Component Revision Attribute enabled
                                    </label>
                                </div>
                                <div class="radio">
                                    <label>
                                        <input id="revisionBot" type="radio" name="ignoreRevisionAttribute"
                                            th:checked="${!initialData.enableIgnoreRevisionAttribute}"
                                            value="unchecked" />
                                        Component Revision Attribute disabled
                                    </label>
                                </div>
                            </div>

                            <div
                                th:replace="fragments/editor :: editor( id='revisionIgnoredPolicyEditor',  label='Edit Ignore Component Revision Policy Settings', bodyContent=~{this::revisionIgnoredPolicyBody})">
                            </div>
                        </li>
                    </ul>
                </form>

                <form th:action="@{/policy/update-pcie-vpd-ignore}" th:object="${initialData}" method="POST">
                    <ul>
                        <li>
                            Ignore PCIE VPD Attribute:
                            <span th:text="${initialData.enableIgnorePcieVpdAttribute ? 'Enabled' : 'Disabled'}"></span>

                            <!-- Define the content of the modal -->
                            <div th:fragment="pcieVpdIgnoredPolicyBody">
                                <div class="radio">
                                    <label>
                                        <input id="pcieVpdTop" type="radio" name="ignorePcieVpdAttribute"
                                            th:checked="${initialData.enableIgnorePcieVpdAttribute}" value="checked" />
                                        PCIE VPD Attribute enabled
                                    </label>
                                </div>
                                <div class="radio">
                                    <label>
                                        <input id="pcieVpdBot" type="radio" name="ignorePcieVpdAttribute"
                                            th:checked="${!initialData.enableIgnorePcieVpdAttribute}"
                                            value="unchecked" />
                                        PCIE VPD Attribute disabled
                                    </label>
                                </div>
                            </div>

                            <div
                                th:replace="fragments/editor :: editor( id='ignorePcieVpdPolicyEditor',  label='Edit Ignore PCIE VPD Policy Settings', bodyContent=~{this::pcieVpdIgnoredPolicyBody})">
                            </div>
                        </li>
                    </ul>
                </form>
            </div>

            <!-- Firmware validation -->
            <div class="aca-input-box">
                <form th:action="@{/policy/update-firmware-validation}" th:object="${initialData}" method="POST">
                    <li>
                        Firmware Validation:
                        <span th:text="${initialData.enableFirmwareValidation ? 'Enabled' : 'Disabled'}"></span>

                        <!-- Define the content of the modal -->
                        <div th:fragment="firmwarePolicyBody">
                            <div class="radio">
                                <label>
                                    <input id="firmwareTop" type="radio" name="fwValidate"
                                        th:checked="${initialData.enableFirmwareValidation}" value="checked" />
                                    Firmware will be validated
                                </label>
                            </div>
                            <div class="radio">
                                <label>
                                    <input id="firmwareBottom" type="radio" name="fwValidate"
                                        th:checked="${!initialData.enableFirmwareValidation}" value="unchecked" />
                                    Firmware will not be validated
                                </label>
                            </div>
                        </div>

                        <div
                            th:replace="fragments/editor :: editor( id='fwrPolicyEditor',  label='Edit Firmware Validation Policy Settings', bodyContent=~{this::firmwarePolicyBody})">
                        </div>
                    </li>
                </form>

                <ul>
                    <form th:action="@{/policy/update-ima-ignore}" th:object="${initialData}" method="POST">
                        <ul>
                            <li>
                                Ignore IMA PCR Entry
                                <span th:text="${initialData.enableIgnoreIma ? 'Enabled' : 'Disabled'}"></span>

                                <!-- Define the content of the modal -->
                                <div th:fragment="imaIgnoredPolicyBody">
                                    <div class="radio">
                                        <label>
                                            <input id="imaTop" type="radio" name="ignoreIma"
                                                th:checked="${initialData.enableIgnoreIma}" value="checked" />
                                            Ignore IMA enabled
                                        </label>
                                    </div>
                                    <div class="radio">
                                        <label>
                                            <input id="imaBot" type="radio" name="ignoreIma"
                                                th:checked="${!initialData.enableIgnoreIma}" value="unchecked" />
                                            Ignore IMA disabled
                                        </label>
                                    </div>
                                </div>

                                <div
                                    th:replace="fragments/editor :: editor( id='ignoreImaPolicyEditor',  label='Edit Ignore IMA Ignore Policy Settings', bodyContent=~{this::imaIgnoredPolicyBody})">
                                </div>
                            </li>
                        </ul>
                    </form>

                    <!-- <form:form method="POST" modelAttribute="initialData" action="policy/update-tboot-ignore">
                    <li>Ignore TBOOT PCRs Entry: ${initialData.enableIgnoreTboot ? 'Enabled' : 'Disabled'}
                        <my:editor id="ignoreTbootPolicyEditor" label="Edit Settings">
                            <div class="radio">
                                <label><input id="tbootTop" type="radio" name="ignoretBoot"
                                        ${initialData.enableIgnoreTboot ? 'checked' : '' } value="checked" /> Ignore
                                    TBoot enabled</label>
                            </div>
                            <div class="radio">
                                <label><input id="tbootBot" type="radio" name="ignoretBoot"
                                        ${initialData.enableIgnoreTboot ? '' : 'checked' } value="unchecked" /> Ignore
                                    TBoot disabled</label>
                            </div>
                        </my:editor>
                    </li>
                </form:form> -->

                    <form th:action="@{/policy/update-tboot-ignore}" th:object="${initialData}" method="POST">
                    </form>

                    <!-- <form:form method="POST" modelAttribute="initialData" action="policy/update-gpt-ignore">
                    <li>Ignore GPT PCRs Entry: ${initialData.enableIgnoreGpt ? 'Enabled' : 'Disabled'}
                        <my:editor id="ignoreGptPolicyEditor" label="Edit Settings">
                            <div class="radio">
                                <label><input id="gptTop" type="radio" name="ignoreGpt" ${initialData.enableIgnoreGpt
                                        ? 'checked' : '' } value="checked" /> Ignore GPT enabled</label>
                            </div>
                            <div class="radio">
                                <label><input id="gptBot" type="radio" name="ignoreGpt" ${initialData.enableIgnoreGpt
                                        ? '' : 'checked' } value="unchecked" /> Ignore GPT disabled</label>
                            </div>
                        </my:editor>
                    </li>
                </form:form> -->

                    <form th:action="@{/policy/update-gpt-ignore}" th:object="${initialData}" method="POST">
                    </form>

                    <!-- <form:form method="POST" modelAttribute="initialData" action="policy/update-os-evt-ignore">
                    <li>Ignore OS Events: ${initialData.enableIgnoreOsEvt ? 'Enabled' : 'Disabled'}
                        <my:editor id="ignoreOsEvtPolicyEditor" label="Edit Settings">
                            <div class="radio">
                                <label><input id="osTop" type="radio" name="ignoreOsEvt" ${initialData.enableIgnoreOsEvt
                                        ? 'checked' : '' } value="checked" /> Ignore Os Events enabled</label>
                            </div>
                            <div class="radio">
                                <label><input id="osBot" type="radio" name="ignoreOsEvt" ${initialData.enableIgnoreOsEvt
                                        ? '' : 'checked' } value="unchecked" /> Ignore Os Events disabled</label>
                            </div>
                        </my:editor>
                    </li>
                </form:form> -->

                    <form th:action="@{/policy/update-os-evt-ignore}" th:object="${initialData}" method="POST">
                    </form>
                </ul>
                </li>
            </div>
        </ul>

        <br />

        <!-- Generate Attestation Certificate  -->
        <div class="aca-input-box">
            <!-- <form:form method="POST" modelAttribute="initialData" action="policy/update-issued-attestation-generation">
                <li>Generate Attestation Certificate: ${initialData.issueAttestationCertificate ? 'Enabled' :
                    'Disabled'}
                    <my:editor id="issuedCertificatePolicyEditor" label="Edit Settings">
                        <div class="radio">
                            <label><input id="aicTop" type="radio" name="attestationCertificateIssued"
                                    ${initialData.issueAttestationCertificate ? '' : 'checked' } value="unchecked" />
                                Never
                                generate an Attestation Certificate</label>
                        </div>
                        <div class="radio">
                            <label><input id="aicMid" type="radio" name="attestationCertificateIssued"
                                    ${initialData.issueAttestationCertificate ? 'checked' : '' } value="checked" />
                                Conditionally
                                generate an Attestation Certificate before 'Not After' expiration date</label>
                        </div>
                    </my:editor>
            </form:form> -->

            <form th:action="@{/policy/update-issued-attestation-generation}" th:object="${initialData}" method="POST">
            </form>

            <ul>
                <!-- <form:form method="POST" modelAttribute="initialData"
                    action="policy/update-attestation-certificate-expiration">
                    <li>Attestation Certificate Validity period: ${initialData.generateOnExpiration ? 'Enabled' :
                        'Disabled'}
                        <my:editor id="issuedCertificatePolicyExpirationEditor" label="Edit Settings">
                            <div class="radio">
                                <label>
                                    <input id="aicBot" type="checkbox" name="generationExpirationOn"
                                        ${initialData.generateOnExpiration ? 'checked' : '' } value="checked" />
                                    Attestation Certificate validity period (Default 3651 days)<br />
                                    Select period in days: <input id="expirationValue" type="text"
                                        name="expirationValue" value="${initialData.expirationValue}" />
                                </label>
                            </div>
                        </my:editor>
                    </li>
                </form:form> -->

                <form th:action="@{/policy/update-attestation-certificate-expiration}" th:object="${initialData}"
                    method="POST">
                </form>

                <!-- <form:form method="POST" modelAttribute="initialData" action="policy/update-issued-cert-threshold">
                    <li>Attestation Certificate Renewal period: ${initialData.generateOnExpiration ? 'Enabled' :
                        'Disabled'}
                        <my:editor id="issuedCertificatePolicyGenerateEditor" label="Edit Settings">
                            <div class="radio">
                                <label>
                                    <input id="aicBot" type="checkbox" name="generationExpirationOn"
                                        ${initialData.generateOnExpiration ? 'checked' : '' } value="checked" />
                                    Renew 'n' days before Attestation Certificate's 'Not After' Validity date (Default
                                    365
                                    days)<br />
                                    Select 'n' period in days: <input id="thresholdValue" type="text"
                                        name="thresholdValue" value="${initialData.thresholdValue}" />
                                </label>
                            </div>
                        </my:editor>
                    </li>
                </form:form> -->

                <form th:action="@{/policy/update-issued-cert-threshold}" th:object="${initialData}" method="POST">
                </form>
            </ul>
            </li>
        </div>
        <br />

        <!-- Generate LDevID Certificate -->
        <div class="aca-input-box">
            <!-- <form:form method="POST" modelAttribute="initialData" action="policy/update-issued-ldevid-generation">
                <li>Generate LDevID Certificate: ${initialData.issueDevIdCertificate ? 'Enabled' : 'Disabled'}
                    <my:editor id="issuedDevIdCertificatePolicyEditor" label="Edit Settings">
                        <div class="radio">
                            <label><input id="devIdTop" type="radio" name="devIdCertificateIssued"
                                    ${initialData.issueDevIdCertificate ? '' : 'checked' } value="unchecked" /> Never
                                generate
                                a
                                DevID Certificate</label>
                        </div>
                        <div class="radio">
                            <label><input id="devIdMid" type="radio" name="devIdCertificateIssued"
                                    ${initialData.issueDevIdCertificate ? 'checked' : '' } value="checked" />
                                Conditionally
                                generate an DevID Certificate before 'Not After' expiration date</label>
                        </div>
                    </my:editor>
            </form:form> -->

            <form th:action="@{/policy/update-issued-ldevid-generation}" th:object="${initialData}" method="POST">
            </form>

            <ul>
                <!-- <form:form method="POST" modelAttribute="initialData"
                    action="policy/update-ldevid-certificate-expiration">
                    <li>LDevID Certificate Validity period: ${initialData.devIdExpirationFlag ? 'Enabled' :
                        'Disabled'}
                        <my:editor id="issuedDevIdCertificatePolicyExpirationEditor" label="Edit Settings">
                            <div class="radio">
                                <label>
                                    <input id="devIdBot" type="checkbox" name="devIdExpirationChecked"
                                        ${initialData.devIdExpirationFlag ? 'checked' : '' } value="checked" />
                                    LDevID Certificate validity period (Default 3651 days)<br />
                                    Select period in days: <input id="devIdExpirationValue" type="text"
                                        name="devIdExpirationValue" value="${initialData.devIdExpirationValue}" />
                                </label>
                            </div>
                        </my:editor>
                    </li>
                </form:form> -->

                <form th:action="@{/policy/update-ldevid-certificate-expiration}" th:object="${initialData}"
                    method="POST">
                </form>


                <!-- <form:form method="POST" modelAttribute="initialData" action="policy/update-ldevid-threshold">
                    <li>LDevID Certificate Renewal period: ${initialData.devIdExpirationFlag ? 'Enabled' : 'Disabled'}
                        <my:editor id="issuedDevIdCertificatePolicyGenerateEditor" label="Edit Settings">
                            <div class="radio">
                                <label>
                                    <input id="devIdBot" type="checkbox" name="devIdExpirationChecked"
                                        ${initialData.devIdExpirationFlag ? 'checked' : '' } value="checked" />
                                    Renew 'n' days before LDevID Certificate's 'Not After' Validity date (Default 365
                                    days)<br />
                                    Select 'n' period in days: <input id="devIdThresholdValue" type="text"
                                        name="devIdThresholdValue" value="${initialData.devIdThresholdValue}" />
                                </label>
                            </div>
                        </my:editor>
                    </li>
                </form:form> -->

                <form th:action="@{/policy/update-ldevid-threshold}" th:object="${initialData}" method="POST">
                </form>

            </ul>
            </li>
        </div>
        <br />


        <!-- Save ProtoBuf Data To ACA Log After Validation -->
        <div class="aca-input-box">
            <!-- <form:form method="POST" modelAttribute="initialData" action="policy/update-save-protobuf-data-to-log">
                <li> Save Protobuf Data To ACA Log Settings:
                    <ul>
                        <div class="radio">
                            <input type="radio" name="saveProtobufToLogOption" value="always-log-protobuf"
                                ${initialData.logProtobufAlways ? 'checked' : '' } />
                            Log Protobuf Data Always<br />
                            <input type="radio" name="saveProtobufToLogOption" value="log-protobuf-on-fail-val"
                                ${initialData.logProtobufOnFailedVal? 'checked' : '' } />
                            Log Protobuf Data on Validation Failure<br />
                            <input type="radio" name="saveProtobufToLogOption" value="never-log-protobuf"
                                ${initialData.logProtobufNever ? 'checked' : '' } />
                            Never Log Protobuf Data<br />
                        </div>
                    </ul>
                </li>
            </form:form> -->

            <form th:action="@{/policy/update-save-protobuf-data-to-log}" th:object="${initialData}" method="POST">
            </form>
        </div>
        <br />
        </ul>
    </section>
</body>